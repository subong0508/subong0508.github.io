<!DOCTYPE html>
<html>

  <head>
  
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        TeX: {
          equationNumbers: {
            autoNumber: "AMS"
          }
        },
        tex2jax: {
        inlineMath: [ ['$', '$'] ],
        displayMath: [ ['$$', '$$'] ],
        processEscapes: true,
      }
    });
    MathJax.Hub.Register.MessageHook("Math Processing Error",function (message) {
          alert("Math Processing Error: "+message[1]);
        });
    MathJax.Hub.Register.MessageHook("TeX Jax - parse error",function (message) {
          alert("Math Processing Error: "+message[1]);
        });
    </script>
    <script type="text/javascript" async
      src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
    </script>
    
  
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Improved Techniques for Training GANs</title>
  <meta name="description" content="오늘 리뷰할 논문은 Improved Techniques for Training GANs로, 이 논문은 아래와 같이 크게 세 가지 내용으로 이루어져 있다.">
  
  <meta name="author" content="Jung Jaeeun">
  <meta name="copyright" content="&copy; Jung Jaeeun 2021">
  

  <!-- External libraries -->
  <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.5/styles/monokai_sublime.min.css">
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/lightbox2/2.7.1/css/lightbox.css">

  <!-- Favicon and other icons (made with http://www.favicon-generator.org/) -->
  <link rel="shortcut icon" href="/assets/icons/favicon.ico" type="image/x-icon">
  <link rel="icon" href="/assets/icons/favicon.ico" type="image/x-icon">
  <link rel="apple-touch-icon" sizes="57x57" href="/assets/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/assets/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/assets/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/assets/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/assets/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/assets/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/assets/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/assets/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/assets/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192"  href="/assets/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/assets/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/assets/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/assets/icons/favicon-16x16.png">
  <link rel="manifest" href="/assets/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/assets/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">

  
  <!-- Facebook OGP cards -->
  <meta property="og:description" content="오늘 리뷰할 논문은 Improved Techniques for Training GANs로, 이 논문은 아래와 같이 크게 세 가지 내용으로 이루어져 있다." />
  <meta property="og:url" content="http://subong0508.github.io" />
  <meta property="og:site_name" content="Data Vision" />
  <meta property="og:title" content="Improved Techniques for Training GANs" />
  <meta property="og:type" content="website" />
  <meta property="og:image" content="http://subong0508.github.io/assets/logo.png" />
  <meta property="og:image:type" content="image/png" />
  <meta property="og:image:width" content="612" />
  <meta property="og:image:height" content="605" />
  

  
  <!-- Twitter: card tags -->
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Improved Techniques for Training GANs">
  <meta name="twitter:description" content="오늘 리뷰할 논문은 Improved Techniques for Training GANs로, 이 논문은 아래와 같이 크게 세 가지 내용으로 이루어져 있다.">
  <meta name="twitter:image" content="http://subong0508.github.io/assets/logo.png">
  <meta name="twitter:url" content="http://subong0508.github.io">
  

  

  <!-- Site styles -->
  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="http://subong0508.github.io/generative-models/2020/12/27/Improved-Techniques-for-Training-GANs.html">
  <link rel="alternate" type="application/rss+xml" title="Data Vision" href="http://subong0508.github.io/feed.xml" />
</head>


  <body>

    <header class="navigation" role="banner">
  <div class="navigation-wrapper">
    <a href="/" class="logo">
      
      <img src="/assets/logo.png" alt="Data Vision">
      
    </a>
    <a href="javascript:void(0)" class="navigation-menu-button" id="js-mobile-menu">
      <i class="fa fa-bars"></i>
    </a>
    <nav role="navigation">
      <ul id="js-navigation-menu" class="navigation-menu show">
        
          
          <li class="nav-link"><a href="/about/">About</a>
          
        
          
        
          
        
          
        
          
          <li class="nav-link"><a href="/posts/">Posts</a>
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      </ul>
    </nav>
  </div>
</header>


    <div class="page-content">
        <div class="post">

<div class="post-header-container " >
  <div class="scrim ">
    <header class="post-header">
      <h1 class="title">Improved Techniques for Training GANs</h1>
      <p class="info">by <strong>Jung Jaeeun</strong></p>
    </header>
  </div>
</div>

<div class="wrapper">

 <span class="page-divider">
  <span class="one"></span>
  <span class="two"></span>
</span>
 

<section class="post-meta">
  <div class="post-date">December 27, 2020</div>
  <div class="post-categories">
  in 
    
    <a href="/category/generative-models">Generative-models</a>
    
  
  </div>
</section>  

<article class="post-content">
  <p>오늘 리뷰할 논문은 Improved Techniques for Training GANs로, 이 논문은 아래와 같이 크게 세 가지 내용으로 이루어져 있다.</p>

<ol>
  <li>GAN의 convergence를 위한 휴리스틱한 방법론들</li>
  <li>사람이 측정한 것과 비슷하게 이미지 퀄리티를 측정하는 방법</li>
  <li>Semi-supervised learning에 GAN을 이용하는 법과 그 중요성</li>
</ol>

<p>편의상 generator를 G, discriminator를 D라고 칭하겠다.</p>

<h2 id="toward-convergent-gan-training">Toward Convergent GAN Training</h2>

<h3 id="feature-matching">Feature Matching</h3>

<p>D의 direct output에 맞춰 업데이트되는 G와 다르게 이 논문에서는 새로운 objective를 설정했다. $\mathbf{f(x)}$를 D의 intermediate layer output이라고 했을 때, G의 새로운 목표는 $\vert\vert \mathbb{E_{x \thicksim p_{data}}}\mathbf{f(x)} - \mathbb{E_{z \thicksim p_{z}}}\mathbf{f}(G(z))\vert\vert^{2}$를 최소화하는 것이 된다.(D는 기존의 방식대로 학습됨) <strong>즉, 직접적인 비용이 아니라 D가 기대하는 feature에 G를 맞추는 것이다.</strong></p>

<h3 id="minibatch-discrimination">Minibatch discrimination</h3>

<p>GAN에서 흔하게 나타나는 현상이 mode collapsing으로 D가 제일 헷갈리는 sample 하나만 G가 생성하는 것이다. 이 논문에서는 이러한 현상을 막기 위해서 D가 여러 샘플을 보게 하는 학습 기법을 <em>minibatch discrimination</em>이라고 칭한다.</p>

<p>구체적인 학습 방법은 이렇다. $\mathbf{f(x_{i})} \in \mathbb{R}^{A}$에 matrix $T \in \mathbb{R}^{A \times B \times C}$를 곱힌 결과를 $M_{i} \in \mathbb{R}^{B \times C}$라고 하자. 이 $M_{i}$의 행들간의 $L$-1 distance를 구하고 그 값에다가 negative exponential을 취한 값을 모두 합해서 학습에 사용한다.</p>

<p>$\sigma(x_{i, b})= \sum_{j=1}^{n} c_{b}(x_{i}, x_{j}) = \sum_{j=1}^{n} \exp(- \vert\vert M_{i, b} - M_{j, b} \vert\vert)\in \mathbb{R}$</p>

<p>$\sigma(x_{i}) = [\sigma(x_{i, 1}), …, \sigma(x_{i, B})] \in \mathbb{R}^{B}$</p>

<p>$\sigma(\mathbb{X}) \in \mathbb{R}^{n \times B}$</p>

<p>$\sigma(\mathbb{x_{i}})$를 $\mathbf{f(x_{i})}$에 concat해서 D의 next layer에 정보를 전달한다. 따라서 D는 현재 판단하는 sample뿐만 아니라 minibatch를 <em>side information</em>으로 사용한다.</p>

<h3 id="historical-averaging">Historical averaging</h3>

<p>이 기술은 cost에 $\vert\vert \mathbf{\theta} - \frac{1}{t}\sum_{i=1}^{t}\mathbf{\theta}[i]\vert\vert^{2}$ term을 포함하는 것이다. 이렇게 함으로써 online-learning의 효과를 갖게 되고 전에 배웠던 학습 정보를 잃지 않게 된다.</p>

<h3 id="one-sided-label-smoothing">One-sided label smoothing</h3>

<p>이 발상은 positive targets 갯수가 $\alpha$개, negative targets 갯수가 $\beta$개 일때 optimal D가 $D(x) = \frac{\alpha p_{data}(x) + \beta p_{model}(x)}{p_{data}(x) + p_{model}(x)}$가 되고 $p_{data}$가 0이고 $p_{model}$이 매우 클 때 G가 제대로 학습이 되지 않는다는 점에서 착안했다. 따라서 positive labels만 $\alpha$, negative labels는 0으로 smoothing 한다.</p>

<h3 id="virtual-batch-normalization">Virtual batch normalization</h3>

<p>DCGAN에서 batch normalization이 GAN의 성능을 크게 향상시킨다고 입증했지만 batch에 따라 성능이 크게 좌우된다. 따라서 학습을 시작할 때 <em>reference batch</em>를 만들어서 <em>reference batch</em>에 collect된 통계량을 통해 정규화를 진행한다.</p>

<h2 id="assessment-of-image-quality">Assessment of image quality</h2>

<p>원래는 GAN의 성능을 측정하기 위해 human anotators를 사용했는데, 이 논문에서는 <strong>Inception module</strong> 이라는 human evaluation과 correlation이 높은 새로운 대안을 제시한다.</p>

<p>우리는 우리 model이 $p(y \vert x)$는 low entropy를 갖고, $\int p(y \vert x = G(z))dx$가 high entropy를 갖기를 기대한다. 따라서 $\exp (\mathbb{E_{x}} KL(p(y \vert x) \vert\vert p(y)))$를 새로운 metric으로 제시한다. 막상 이 metric을 학습에 사용해서는 큰 효과를 보지 못했지만, human evaluation과 human judgement와 큰 양의 상관관계가 있다고 한다.</p>

<h2 id="semi-supervised-learning">Semi-supervised learning</h2>

<p>image를 K개의 클래스로 분류하는 classifier를 생각해보자. 이 모델의 마지막 레이어에서는 K-dimensional logit이 아웃풋이 된다. 즉, $[l_{1}, …, l_{K}]$을 통해 $p(y=j \vert x) = \frac{\exp (l_{j})}{\sum_{k=1}^{K} \exp(l_{k})}$를 구한다.</p>

<p>여기서, G가 생성해낸 새로운 클래스를 $K+1$로 명명하고 classifier는 $p_{model}(y=K+1 \vert x)$까지 구분하도록 바뀐다. <strong>이로써 classifier는 unlabeled data(G에 의해 생성된 데이터)까지 활용하여 학습할 수 있다.</strong> 새로운 Loss function은 아래처럼 바뀐다.</p>

<p><img src="../../../../img/gans/new-loss.png" alt="new loss" /></p>

<p>사실 $L_{unsupervised}$는 G가 그럴듯한 이미지를 생성할 때만 도움이 된다. 이를 강제하는 방식은 D를 classifier로 바꾸고 G, D를 동시에 학습시키는 것이다. 이 방식으로 학습된 G를 통해 생성된 이미지는 human annotators로부터 좋은 평가를 받았다고 한다. 필자들은 본능적으로 사람이 이미지를 보았을 때 특정한 카테고리로 분류한다는 점에서 이런 결과가 나왔다고 설명한다. D로 하여금 <em>objectness</em>를 측정하게 하는 것이다.</p>

<p>위에 열거한 기법들을 통해 필자들은 큰 발전을 이루었다고 말하고 있다. 물론 이 기법들은 대부분 empirical results에 의존하고, 마땅히 이렇다할 이론적 근거들은 없다. 하지만 minibatch discrimination 같은 기법은 GAN 뿐만 아니라 다른 neural network에도 사용될 수 있을 것 같다.</p>

</article>



<section class="tags">
  <strong>Tags:</strong> <a href="/tag/GAN">GAN</a>,&nbsp;<a href="/tag/deep-learning">deep-learning</a>
</section>



<section class="rss">
  <p class="rss-subscribe text"><strong>Subscribe <a href="/feed.xml">via RSS</a></strong></p>
</section>

<section class="share">
  <span>Share: </span>
  
    
    
    
    
    
    
    
  
</section>

	<section class="post-navigation">
		<span class="prev-post">
			
				<a href="/generative-models/2020/12/22/from-Variational-Inference-to-VAE.html">
					<span class="fa-stack fa-lg">
						<i class="fa fa-square fa-stack-2x"></i>
						<i class="fa fa-angle-double-left fa-stack-1x fa-inverse"></i>
					</span>
					<span class="page-number">from Variational Inference to VAE</span>
				</a>
			
		</span>
		<span class="next-post">
			
				<a href="/generative-models/2020/12/29/Wasserstein-GAN.html">
					<span class="page-number">Wasserstein GAN</span>
					<span class="fa-stack fa-lg">
						<i class="fa fa-square fa-stack-2x"></i>
						<i class="fa fa-angle-double-right fa-stack-1x fa-inverse"></i>
					</span>
				</a>
			
		</span>
	</section>




<section class="disqus">
  <div id="disqus_thread"></div>
  <script type="text/javascript">
    var disqus_shortname = 'subong0508-github-io';

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</section>



</div>
</div>

    </div>

    <footer class="site-footer">

  <div class="wrapper">

    <h3 class="footer-heading">Data Vision</h3>

    <div class="site-navigation">
      
      <p><strong>Site Map</strong></p>
      <ul class="pages">
        
        
          <li class="nav-link"><a href="/about/">About</a>
        
        
        
        
        
        
        
        
        
          <li class="nav-link"><a href="/posts/">Posts</a>
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
      </ul>
    </div>

    <div class="site-contact">

      <p><strong>Contact</strong></p>
      <ul class="social-media-list">
        <li>
          <a href="mailto:subong0508@naver.com">
            <i class="fa fa-envelope-o"></i>
            <span class="username">subong0508@naver.com</span>
          </a>
        </li>

        
          
          <li>
            <a href="https://github.com/subong0508" title="Fork me on GitHub">
              <i class="fa fa-github"></i>
              <span class="username">subong0508</span>
            </a>
          </li>
          
        

      </ul>
    </div>

    <div class="site-signature">
      <p class="rss-subscribe text"><strong>Subscribe <a href="/feed.xml">via RSS</a></strong></p>
      <p class="text">My personal blog for studying; mainly related to data
</p>
    </div>

  </div>

</footer>

<!-- Scripts -->
<script src="//code.jquery.com/jquery-1.11.2.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.5/highlight.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/lightbox2/2.7.1/js/lightbox.min.js"></script>
<script>

$(document).ready(function() {

  // Syntax highlighting
  hljs.initHighlightingOnLoad();

  // Header
  var menuToggle = $('#js-mobile-menu').unbind();
  $('#js-navigation-menu').removeClass("show");
  menuToggle.on('click', function(e) {
    e.preventDefault();
    $('#js-navigation-menu').slideToggle(function(){
      if($('#js-navigation-menu').is(':hidden')) {
        $('#js-navigation-menu').removeAttr('style');
      }
    });
  });


});

</script>




  </body>

</html>
